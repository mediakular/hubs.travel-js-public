(()=>{function ne(e){let o=document.querySelectorAll(".room-price-data"),t=Array.from(o).map(r=>JSON.parse(r.textContent));return e?t.filter(r=>r.editionSlug===e):t}function z(e,o){return!e||!o?0:Math.floor((o-e)/(1e3*60*60*24*30))}function y(e,o){return new Intl.NumberFormat("de-DE",{style:"currency",currency:o,currencyDisplay:"code"}).format(e)}function L(e,o=null){return isNaN(parseFloat(e))?o:parseFloat(e)}function re(){document.querySelectorAll("[data-trigger]").forEach(t=>{t.addEventListener("change",()=>o(t)),o(t)});function o(t){let r=t.getAttribute("data-trigger"),s=t.value;document.querySelectorAll(`[data-condition-trigger="${r}"]`).forEach(d=>{let u=d.getAttribute("data-condition-value")===s,l=d.matches("input, select, textarea")?d:d.querySelector("input, select, textarea");d.style.display=u?"block":"none",l&&(l.required=u,u||(l.value=""))})}}function se(){document.querySelectorAll("[data-custom-dropdown]").forEach(e=>{let o=document.createElement("input");o.type="hidden",o.name=e.dataset.name||"custom-dropdown",o.setAttribute("required",e.dataset.required==="true"||!1),o.value="",e.appendChild(o);let t=e.querySelector(".dropdown-selected-value");e.querySelectorAll(".dropdown-item").forEach(s=>{s.addEventListener("click",i=>{i.preventDefault();let d=s.dataset.value,u=s.cloneNode(!0);u.style.padding=0,t.innerHTML="",t.appendChild(u),o.value=d})})})}function ie(e,o,t=30){let r=document.querySelector(e),s=document.querySelector(o),i=new DateRangePicker(r,{format:"dd. MM yyyy"}),d=t;return i.setMinimumDays=u=>{d=u},i.validateDateRange=()=>{let[u,l]=i.getDates();u&&l&&Math.floor((l-u)/864e5)<d?(s.setCustomValidity(`You need to choose a minimum of ${d} days.`),i.setDates(u,new Date(u.getTime()+d*24*60*60*1e3))):s.setCustomValidity(""),s.reportValidity()},r.addEventListener("changeDate",i.validateDateRange),{rangepicker:i,datesInput:r,startDateField:s}}function ce(){let e=document.querySelectorAll(".form-step"),o=document.querySelectorAll(".form-wizard-step .form-wizard-step-progress"),t=0;function r(l){e.forEach((n,a)=>{n.style.display=a===l?"block":"none"}),o.forEach((n,a)=>{a<l||a===l?n.classList.add("active"):n.classList.remove("active")})}function s(){let l=e[t].querySelectorAll("input, select, textarea"),n=[];return l.forEach(a=>{let f=a.type==="hidden"||a.offsetParent===null;if(a.required&&(!a.value||a.value.trim()==="")){let S=a.dataset.name||a.name||a.placeholder||"Unnamed field";n.push(`${S} is required.`)}if(!f&&a.value&&!a.checkValidity()){let h=a.name||a.placeholder||"Unnamed field";n.push(`${h} is invalid.`)}}),n}function i(l,n){let a=document.querySelector(l);if(!a)return;a.innerHTML="";let f=document.createElement("ul");n.forEach(h=>{let S=document.createElement("li");S.textContent=h,f.appendChild(S)}),a.appendChild(f)}function d(l){let n=document.querySelector(l);n&&(n.innerHTML="")}document.querySelectorAll(".form-next-step-btn").forEach(l=>{l.addEventListener("click",()=>{if(l.getAttribute("disabled")==="true")return;let n=s(),a=`#error-list-step-${t}`;d(a),n.length==0?(t=Math.min(t+1,e.length-1),t===e.length-1&&u(),r(t)):i(a,n)})});function u(){document.querySelectorAll('[id^="review-"]').forEach(n=>{let a=n.dataset.fieldname;try{let f=document.querySelector(`[name="${a}"]`).value;n.innerText=f}catch{}})}document.querySelectorAll(".form-previous-step-btn").forEach(l=>{l.addEventListener("click",()=>{t=Math.max(t-1,0),r(t)})}),r(t)}function ae(){document.getElementById("close-button").addEventListener("click",function(){let e=document.referrer,o=window.location.hostname,t=null;try{t=e?new URL(e).hostname:null}catch{t=null}window.history.length>1&&t===o?window.history.back():window.location.href="/"})}var p="EUR",Y=null,de=80;function le(e){let o=document.querySelectorAll(".edition-data");return Array.from(o).map(r=>JSON.parse(r.textContent)).find(r=>r.editionSlug===e)||null}function ye(e){let o=document.querySelectorAll(".destination-data");return Array.from(o).map(r=>JSON.parse(r.textContent)).find(r=>r.destinationSlug===e)||null}document.addEventListener("DOMContentLoaded",function(){ae(),re(),ce(),se(),Y=ie("#dates-start-end-group","#Start-Date"),ge(),Se(),we(),he(),De()});function he(){let e=new URLSearchParams(window.location.search),o=e.get("destination"),t=e.get("edition"),r=e.get("room"),s=e.get("guests");o&&J("#destination-dropdown",o,"data-destinationslug");let i=t&&J("#edition-dropdown",t,"data-editionslug");if(r&&J("#room-dropdown",r,"data-roomslug"),s){let d=document.getElementById("Guests");d&&(d.value=s)}if(i){let d=i.dataset.startdate,u=i.dataset.enddate,l=i.dataset.editionslug||"",n=Y.rangepicker;n.setOptions({minDate:d,maxDate:u}),n.setDates(d,u),_(l)}}function ge(){let e=document.querySelector("#destination-dropdown"),o=document.querySelector("#edition-dropdown"),t=o.querySelector(".dropdown-selected-value"),r=t.innerHTML,s=document.querySelector("#room-dropdown"),i=s.querySelector(".dropdown-selected-value"),d=e.querySelectorAll(".dropdown-item"),u=o.querySelectorAll(".dropdown-item"),l=s.querySelectorAll(".dropdown-item");function n(a,f){t.setAttribute("disabled",a===""?"true":"false"),i.setAttribute("disabled",a===""?"true":"false"),t.innerHTML=r,i.innerHTML=r,p=f,[...u,...l].forEach(h=>{let S=h.dataset.destinationslug===a;h.style.display=S?"flex":"none"}),_("")}n("",p),d.forEach(a=>{a.addEventListener("click",function(){n(this.dataset.destinationslug,this.dataset.currency)})})}function J(e,o,t){let r=document.querySelectorAll(`${e} .dropdown-item`),s=r&&Array.from(r).find(i=>i.getAttribute(t)===o);return s&&s.click(),s}function Se(){let o=document.querySelector("#edition-dropdown").querySelectorAll(".dropdown-item"),t=document.querySelector("#dates-start-end-group");function r(s,i,d){let u=t.rangepicker;u.setOptions({minDate:s,maxDate:i}),u.setDates(s,i),_(d)}o.forEach(s=>{s.addEventListener("click",function(){let i=this.dataset.editionslug||"";r(this.dataset.startdate,this.dataset.enddate,i)})})}function _(e){let o=document.querySelector(".additional-booking-info"),t=document.querySelector(".additional-booking-info-text");if(!o||!t)return;if(!e){o.style.display="none";return}let s=le(e)?.additionalBookingInfo||"";s&&s.trim()!==""?(t.textContent=s,o.style.display=""):o.style.display="none"}function we(){document.querySelector("#dates-start-end-group").addEventListener("changeDate",()=>{P(),ue()}),document.querySelector("#room-dropdown").querySelectorAll(".dropdown-item").forEach(u=>{u.addEventListener("click",()=>{P();let l=u.getAttribute("data-allow-weekly-booking"),n=Y.rangepicker;n.setMinimumDays(l==="Enabled"?7:30),n.validateDateRange()})}),document.querySelector("#Guests").addEventListener("change",()=>{P()});let s=document.querySelector("#pet-travel-checkbox"),i=document.querySelector("#pet-count-input");s&&s.addEventListener("change",()=>{P()}),i&&(i.addEventListener("input",()=>{P()}),i.addEventListener("change",()=>{P()}));let d=document.querySelector("#get-membership-checkbox");d&&d.addEventListener("change",()=>{P()})}function De(){ue(),P()}function ue(){let o=document.querySelector("#dates-start-end-group").rangepicker,t=document.querySelector(".discount-info-blue"),r=document.querySelector(".discount-info-green"),[s,i]=o.getDates(),d=z(s,i);!s||!i||d<=2?(t.style.display="flex",r.style.display="none"):(t.style.display="none",r.style.display="flex")}function P(){let e=document.querySelectorAll(".price-info-card"),t=document.querySelector("#dates-start-end-group").rangepicker,r=document.querySelector("#destination-dropdown .dropdown-selected-value .dropdown-item"),s=document.querySelector("#edition-dropdown .dropdown-selected-value .dropdown-item"),i=document.querySelector("#room-dropdown .dropdown-selected-value .dropdown-item"),d=document.querySelector("#Guests"),u=r?r.dataset.destinationslug:"",l=s?s.dataset.editionslug:"",n=i?i.dataset.roomslug:"",a=i?i.getAttribute("data-allow-weekly-booking")==="Enabled":!1,[f,h]=t.getDates(),S=d?parseInt(d.value):0;if(u&&l&&n&&f&&h&&S>0){let w=ye(u),D=document.querySelector("#pet-travel-section");if(D)if(w&&w.allowPets==="true")D.style.display="flex";else{D.style.display="none";let x=document.querySelector("#pet-travel-checkbox"),R=document.querySelector("#pet-count-input");x&&(x.checked=!1),R&&(R.value="1")}let M=ne();e.forEach(x=>{x.style.display="flex",qe(x,M,l,n,f,h,S,a)});let $={day:"numeric",month:"short",year:"numeric"},C=f.toLocaleDateString("en-GB",{day:"numeric",month:"short"}).replace(",",""),V=h.toLocaleDateString("en-GB",$).replace(",","");document.querySelectorAll(".total-dates").forEach(x=>x.innerHTML=`${C} - ${V}`)}else{e.forEach(D=>D.style.display="none");let w=document.querySelector("#pet-travel-section");w&&(w.style.display="none")}}function qe(e,o,t,r,s,i,d,u){function l(c){return c===1?"st":c===2?"nd":c===3?"rd":"th"}function n(c,m){c&&(c.style.display=m)}function a(c,m,g){!c||!m||(m.style.pointerEvents=g?"auto":"none",m.style.backgroundColor=g?"var(--_colors---primary)":"var(--_colors---light-silver)",m.style.opacity=g?1:.3,c.setAttribute("disabled",!g))}function f(){x.innerText="No room price found for the selected season or room.",n(C,"none"),n(w,"none"),n(D,"none"),n($?.parentElement,"none"),n(R,"none"),n(M,"none"),a(F,j,!1),Q.forEach(c=>n(c,"none")),G&&(G.value=0)}function h(){n(C,"block"),n(w,"block"),n($?.parentElement,"flex"),n(R,"block"),n(M,"block"),a(F,j,!0),Q.forEach(c=>n(c,"block"))}let S=z(s,i),w=e.querySelector(".room-price"),D=e.querySelector(".room-price-discount"),M=e.querySelector(".room-price-month-desc"),$=e.querySelector(".total-guests"),C=e.querySelector(".total-totalprice"),V=C.firstElementChild,x=e.querySelector(".room-price-breakdown"),R=e.querySelector(".total-dates"),F=document.querySelector("#form-next-step-btn-step-1"),j=F?F.querySelector("a"):null,A=o.find(c=>c.editionSlug===t&&c.roomSlug===r),Q=e.querySelectorAll(".price-info-card-title"),G=document.querySelector('[name="Total-Price"]');if(!A){f();return}h();let T=le(t),H=L(A.basePriceWeek),O=A.basePriceMonth,me=A.discountMonth2,pe=A.discountMonth3,k=0,q=[],I=Math.round((i-s)/(1e3*60*60*24));if(S<1&&u&&H){n(D,"none"),w.innerText=`${y(H,p)}`,M.innerText="per week";let m=H/7*I;q.push({text:`${I} days: ${y(m,p)}`}),k=m;let g=L(A.surcharge2ndPerson,0);if(d===2&&g>0){let v=g/30*I;v>0&&(q.push({text:`2nd person surcharge: ${y(v,p)}`}),k+=v)}}else if(S>=1){let c=I,m=1,g=0,ee=0,v=0,te=L(A.surcharge2ndPerson,0),oe=d===2&&te>0;for(;c>0;){let E=0;m===1?E=0:m===2?E=me:m>=3&&(E=pe),g=E;let B=c>=30?30:c;ee=B;let W=O*(1-E/100)/30*B;if(k+=W,q.push({text:B===30?`Month ${m}: ${y(W,p)}`:`+ ${c} days: ${y(W,p)}`,discount:E,month:m}),oe){let fe=te*(1-E/100)/30*B;v+=fe}c-=B,m++}let b=q[q.length-1];if(b&&b.discount!==void 0&&b.discount>0){let E=b.month<=3?`${b.month}${l(b.month)} month`:"from 3rd month";D.innerText=`${b.discount.toFixed(1)}% discount - ${E}`,n(D,"flex"),w.innerText=`${y(O*(1-b.discount/100),p)}`,M.innerText=E}else n(D,"none"),w.innerText=`${y(O,p)}`,M.innerText="1st month";oe&&v>0&&(q.push({text:`2nd person surcharge: ${y(v,p)}`}),k+=v)}let U=0;if(T){if(I>=1&&T.taxFirstMonth){let c=L(T.taxFirstMonth,0);c>0&&(U+=c,q.push({text:`Tax (1st month): ${y(c,p)}`}))}if(I>30&&T.taxSecondMonth){let c=L(T.taxSecondMonth,0);c>0&&(U+=c,q.push({text:`Tax (2nd month): ${y(c,p)}`}))}}k+=U;let N=0,K=document.querySelector("#pet-travel-checkbox"),X=document.querySelector("#pet-count-input");if(K&&K.checked&&X&&T){let c=parseInt(X.value)||0,m=L(T.petPricePerMonth,0);if(c>0&&m>0){let g=I/30;N=m*g*c,N>0&&q.push({text:`Pet${c>1?"s":""} (${c} \xD7 ${g.toFixed(1)} month${g!==1?"s":""}): ${y(N,p)}`})}}k+=N;let Z=document.querySelector("#get-membership-checkbox");Z&&Z.checked&&(q.push({text:`1 Year Membership: ${y(de,p)}`}),k+=de),x.innerHTML=q.map(c=>c.text).join("<br>"),$.innerText=`${d} x Person`,V.innerText=`${y(k,p)}`,G&&(G.value=`${y(k,p)}`)}})();
