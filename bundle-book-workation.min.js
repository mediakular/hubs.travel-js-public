(()=>{function z(e){let n=document.querySelectorAll(".room-price-data"),t=Array.from(n).map(c=>JSON.parse(c.textContent));return e?t.filter(c=>c.editionSlug===e):t}function F(e,n){return!e||!n?0:Math.floor((n-e)/(1e3*60*60*24*30))}function S(e,n){return new Intl.NumberFormat("de-DE",{style:"currency",currency:n,currencyDisplay:"code"}).format(e)}function O(e,n=null){return isNaN(parseFloat(e))?n:parseFloat(e)}function _(){document.querySelectorAll("[data-trigger]").forEach(t=>{t.addEventListener("change",()=>n(t)),n(t)});function n(t){let c=t.getAttribute("data-trigger"),r=t.value;document.querySelectorAll(`[data-condition-trigger="${c}"]`).forEach(a=>{let u=a.getAttribute("data-condition-value")===r,l=a.matches("input, select, textarea")?a:a.querySelector("input, select, textarea");a.style.display=u?"block":"none",l&&(l.required=u,u||(l.value=""))})}}function j(){document.querySelectorAll("[data-custom-dropdown]").forEach(e=>{let n=document.createElement("input");n.type="hidden",n.name=e.dataset.name||"custom-dropdown",n.setAttribute("required",e.dataset.required==="true"||!1),n.value="",e.appendChild(n);let t=e.querySelector(".dropdown-selected-value");e.querySelectorAll(".dropdown-item").forEach(r=>{r.addEventListener("click",i=>{i.preventDefault();let a=r.dataset.value,u=r.cloneNode(!0);u.style.padding=0,t.innerHTML="",t.appendChild(u),n.value=a})})})}function J(e,n,t=30){let c=document.querySelector(e),r=document.querySelector(n),i=new DateRangePicker(c,{format:"dd. MM yyyy"}),a=t;return i.setMinimumDays=u=>{a=u},i.validateDateRange=()=>{let[u,l]=i.getDates();u&&l&&Math.floor((l-u)/864e5)<a?(r.setCustomValidity(`You need to choose a minimum of ${a} days.`),i.setDates(u,new Date(u.getTime()+a*24*60*60*1e3))):r.setCustomValidity(""),r.reportValidity()},c.addEventListener("changeDate",i.validateDateRange),{rangepicker:i,datesInput:c,startDateField:r}}function Q(){let e=document.querySelectorAll(".form-step"),n=document.querySelectorAll(".form-wizard-step .form-wizard-step-progress"),t=0;function c(l){e.forEach((o,s)=>{o.style.display=s===l?"block":"none"}),n.forEach((o,s)=>{s<l||s===l?o.classList.add("active"):o.classList.remove("active")})}function r(){let l=e[t].querySelectorAll("input, select, textarea"),o=[];return l.forEach(s=>{let p=s.type==="hidden"||s.offsetParent===null;if(s.required&&(!s.value||s.value.trim()==="")){let y=s.dataset.name||s.name||s.placeholder||"Unnamed field";o.push(`${y} is required.`)}if(!p&&s.value&&!s.checkValidity()){let f=s.name||s.placeholder||"Unnamed field";o.push(`${f} is invalid.`)}}),o}function i(l,o){let s=document.querySelector(l);if(!s)return;s.innerHTML="";let p=document.createElement("ul");o.forEach(f=>{let y=document.createElement("li");y.textContent=f,p.appendChild(y)}),s.appendChild(p)}function a(l){let o=document.querySelector(l);o&&(o.innerHTML="")}document.querySelectorAll(".form-next-step-btn").forEach(l=>{l.addEventListener("click",()=>{if(l.getAttribute("disabled")==="true")return;let o=r(),s=`#error-list-step-${t}`;a(s),o.length==0?(t=Math.min(t+1,e.length-1),t===e.length-1&&u(),c(t)):i(s,o)})});function u(){document.querySelectorAll('[id^="review-"]').forEach(o=>{let s=o.dataset.fieldname;try{let p=document.querySelector(`[name="${s}"]`).value;o.innerText=p}catch{}})}document.querySelectorAll(".form-previous-step-btn").forEach(l=>{l.addEventListener("click",()=>{t=Math.max(t-1,0),c(t)})}),c(t)}function Y(){document.getElementById("close-button").addEventListener("click",function(){let e=document.referrer,n=window.location.hostname,t=null;try{t=e?new URL(e).hostname:null}catch{t=null}window.history.length>1&&t===n?window.history.back():window.location.href="/"})}var h="EUR",N=null;document.addEventListener("DOMContentLoaded",function(){Y(),_(),Q(),j(),N=J("#dates-start-end-group","#Start-Date"),ne(),re(),se(),oe(),ie()});function oe(){let e=new URLSearchParams(window.location.search),n=e.get("destination"),t=e.get("edition"),c=e.get("room"),r=e.get("guests");n&&G("#destination-dropdown",n,"data-destinationslug");let i=t&&G("#edition-dropdown",t,"data-editionslug");if(c&&G("#room-dropdown",c,"data-roomslug"),r){let a=document.getElementById("Guests");a&&(a.value=r)}if(i){let a=i.dataset.startdate,u=i.dataset.enddate,l=N.rangepicker;l.setOptions({minDate:a,maxDate:u}),l.setDates(a,u)}}function ne(){let e=document.querySelector("#destination-dropdown"),n=document.querySelector("#edition-dropdown"),t=n.querySelector(".dropdown-selected-value"),c=t.innerHTML,r=document.querySelector("#room-dropdown"),i=r.querySelector(".dropdown-selected-value"),a=e.querySelectorAll(".dropdown-item"),u=n.querySelectorAll(".dropdown-item"),l=r.querySelectorAll(".dropdown-item");function o(s,p){t.setAttribute("disabled",s===""?"true":"false"),i.setAttribute("disabled",s===""?"true":"false"),t.innerHTML=c,i.innerHTML=c,h=p,[...u,...l].forEach(f=>{let y=f.dataset.destinationslug===s;f.style.display=y?"flex":"none"})}o("",h),a.forEach(s=>{s.addEventListener("click",function(){o(this.dataset.destinationslug,this.dataset.currency)})})}function G(e,n,t){let c=document.querySelectorAll(`${e} .dropdown-item`),r=c&&Array.from(c).find(i=>i.getAttribute(t)===n);return r&&r.click(),r}function re(){let n=document.querySelector("#edition-dropdown").querySelectorAll(".dropdown-item"),t=document.querySelector("#dates-start-end-group");function c(r,i){let a=t.rangepicker;a.setOptions({minDate:r,maxDate:i}),a.setDates(r,i)}n.forEach(r=>{r.addEventListener("click",function(){c(this.dataset.startdate,this.dataset.enddate)})})}function se(){document.querySelector("#dates-start-end-group").addEventListener("changeDate",()=>{I(),K()}),document.querySelector("#room-dropdown").querySelectorAll(".dropdown-item").forEach(r=>{r.addEventListener("click",()=>{I();let i=r.getAttribute("data-allow-weekly-booking"),a=N.rangepicker;a.setMinimumDays(i==="Enabled"?7:30),a.validateDateRange()})}),document.querySelector("#Guests").addEventListener("change",()=>{I()})}function ie(){K(),I()}function K(){let n=document.querySelector("#dates-start-end-group").rangepicker,t=document.querySelector(".discount-info-blue"),c=document.querySelector(".discount-info-green"),[r,i]=n.getDates(),a=F(r,i);!r||!i||a<=2?(t.style.display="flex",c.style.display="none"):(t.style.display="none",c.style.display="flex")}function I(){let e=document.querySelectorAll(".price-info-card"),t=document.querySelector("#dates-start-end-group").rangepicker,c=document.querySelector("#destination-dropdown .dropdown-selected-value .dropdown-item"),r=document.querySelector("#edition-dropdown .dropdown-selected-value .dropdown-item"),i=document.querySelector("#room-dropdown .dropdown-selected-value .dropdown-item"),a=document.querySelector("#Guests"),u=c?c.dataset.destinationslug:"",l=r?r.dataset.editionslug:"",o=i?i.dataset.roomslug:"",s=i?i.getAttribute("data-allow-weekly-booking")==="Enabled":!1,[p,f]=t.getDates(),y=a?parseInt(a.value):0;if(u&&l&&o&&p&&f&&y>0){let g=z();e.forEach(D=>{D.style.display="flex",ce(D,g,l,o,p,f,y,s)});let E={day:"numeric",month:"short",year:"numeric"},q=p.toLocaleDateString("en-GB",{day:"numeric",month:"short"}).replace(",",""),x=f.toLocaleDateString("en-GB",E).replace(",","");document.querySelectorAll(".total-dates").forEach(D=>D.innerHTML=`${q} - ${x}`)}else e.forEach(g=>g.style.display="none")}function ce(e,n,t,c,r,i,a,u){function l(d){return d===1?"st":d===2?"nd":d===3?"rd":"th"}function o(d,m){d&&(d.style.display=m)}function s(d,m,k){!d||!m||(m.style.pointerEvents=k?"auto":"none",m.style.backgroundColor=k?"var(--_colors---primary)":"var(--_colors---light-silver)",m.style.opacity=k?1:.3,d.setAttribute("disabled",!k))}function p(){V.innerText="No room price found for the selected season or room.",o(D,"none"),o(g,"none"),o(E,"none"),o(x?.parentElement,"none"),o(H,"none"),o(q,"none"),s(P,U,!1),W.forEach(d=>o(d,"none")),L&&(L.value=0)}function f(){o(D,"block"),o(g,"block"),o(x?.parentElement,"flex"),o(H,"block"),o(q,"block"),s(P,U,!0),W.forEach(d=>o(d,"block"))}let y=F(r,i),g=e.querySelector(".room-price"),E=e.querySelector(".room-price-discount"),q=e.querySelector(".room-price-month-desc"),x=e.querySelector(".total-guests"),D=e.querySelector(".total-totalprice"),X=D.firstElementChild,V=e.querySelector(".room-price-breakdown"),H=e.querySelector(".total-dates"),P=document.querySelector("#form-next-step-btn-step-1"),U=P?P.querySelector("a"):null,b=n.find(d=>d.editionSlug===t&&d.roomSlug===c),W=e.querySelectorAll(".price-info-card-title"),L=document.querySelector('[name="Total-Price"]');if(!b){p();return}f();let $=O(b.basePriceWeek),C=b.basePriceMonth,Z=b.discountMonth2,ee=b.discountMonth3,M=0,A=[],R=Math.round((i-r)/(1e3*60*60*24));if(y<1&&u&&$){o(E,"none"),g.innerText=`${S($,h)}`,q.innerText="per week";let m=$/7*R;A.push({text:`${R} days: ${S(m,h)}`}),M=m}else if(y>=1){let d=R,m=1,k=0,te=0;for(;d>0;){let w=0;m===1?w=0:m===2?w=Z:m>=3&&(w=ee),k=w;let T=d>=30?30:d;te=T;let B=C*(1-w/100)/30*T;M+=B,A.push({text:T===30?`Month ${m}: ${S(B,h)}`:`+ ${d} days: ${S(B,h)}`,discount:w,month:m}),d-=T,m++}let v=A[A.length-1];if(v&&v.discount>0){let w=v.month<=3?`${v.month}${l(v.month)} month`:"from 3rd month";E.innerText=`${v.discount.toFixed(1)}% discount - ${w}`,o(E,"flex"),g.innerText=`${S(C*(1-v.discount/100),h)}`,q.innerText=w}else o(E,"none"),g.innerText=`${S(C,h)}`,q.innerText="1st month"}V.innerHTML=A.map(d=>d.text).join("<br>"),x.innerText=`${a} x Person`,X.innerText=`${S(M,h)}`,L&&(L.value=`${S(M,h)}`)}})();
