(()=>{function h(){document.querySelectorAll("[data-trigger]").forEach(t=>{t.addEventListener("change",()=>a(t)),a(t)});function a(t){let l=t.getAttribute("data-trigger"),c=t.value;document.querySelectorAll(`[data-condition-trigger="${l}"]`).forEach(s=>{let i=s.getAttribute("data-condition-value")===c,n=s.matches("input, select, textarea")?s:s.querySelector("input, select, textarea");s.style.display=i?"block":"none",n&&(n.required=i,i||(n.value=""))})}}function p(){document.querySelectorAll("[data-custom-dropdown]").forEach(o=>{let a=document.createElement("input");a.type="hidden",a.name=o.dataset.name||"custom-dropdown",a.setAttribute("required",o.dataset.required==="true"||!1),a.value="",o.appendChild(a);let t=o.querySelector(".dropdown-selected-value");o.querySelectorAll(".dropdown-item").forEach(c=>{c.addEventListener("click",d=>{d.preventDefault();let s=c.dataset.value,i=c.cloneNode(!0);i.style.padding=0,t.innerHTML="",t.appendChild(i),a.value=s})})})}function y(o,a,t=30){let l=document.querySelector(o),c=document.querySelector(a),d=new DateRangePicker(l,{format:"dd. MM yyyy"}),s=t;return d.setMinimumDays=i=>{s=i},d.validateDateRange=()=>{let[i,n]=d.getDates();i&&n&&Math.floor((n-i)/864e5)<s?(c.setCustomValidity(`You need to choose a minimum of ${s} days.`),d.setDates(i,new Date(i.getTime()+s*24*60*60*1e3))):c.setCustomValidity(""),c.reportValidity()},l.addEventListener("changeDate",d.validateDateRange),{rangepicker:d,datesInput:l,startDateField:c}}function E(o){return/^HM\d{6}-\d{3}$/.test(o)}function v(){let o=document.querySelectorAll(".form-step"),a=document.querySelectorAll(".form-wizard-step .form-wizard-step-progress"),t=0;function l(n){o.forEach((r,e)=>{r.style.display=e===n?"block":"none"}),a.forEach((r,e)=>{e<n||e===n?r.classList.add("active"):r.classList.remove("active")})}function c(){let n=o[t].querySelectorAll("input, select, textarea"),r=[];return n.forEach(e=>{let u=e.type==="hidden"||e.offsetParent===null;if(e.required&&(!e.value||e.value.trim()==="")){let f=e.dataset.name||e.name||e.placeholder||"Unnamed field";r.push(`${f} is required.`)}if(!u&&e.value&&!e.checkValidity()){let m=e.name||e.placeholder||"Unnamed field";r.push(`${m} is invalid.`)}if(e.hasAttribute("data-membership-id")&&e.value&&!E(e.value)){let m=e.dataset.name||e.name||e.placeholder||"Membership ID";r.push(`${m} is not a valid Membership ID.`)}}),r}function d(n,r){let e=document.querySelector(n);if(!e)return;e.innerHTML="";let u=document.createElement("ul");r.forEach(m=>{let f=document.createElement("li");f.textContent=m,u.appendChild(f)}),e.appendChild(u)}function s(n){let r=document.querySelector(n);r&&(r.innerHTML="")}document.querySelectorAll(".form-next-step-btn").forEach(n=>{n.addEventListener("click",()=>{if(n.getAttribute("disabled")==="true")return;let r=c(),e=`#error-list-step-${t}`;s(e),r.length==0?(t=Math.min(t+1,o.length-1),t===o.length-1&&i(),l(t)):d(e,r)})});function i(){document.querySelectorAll('[id^="review-"]').forEach(r=>{let e=r.dataset.fieldname;try{let u=document.querySelector(`[name="${e}"]`).value;r.innerText=u}catch{}})}document.querySelectorAll(".form-previous-step-btn").forEach(n=>{n.addEventListener("click",()=>{t=Math.max(t-1,0),l(t)})}),l(t)}function g(){document.getElementById("close-button").addEventListener("click",function(){let o=document.referrer,a=window.location.hostname,t=null;try{t=o?new URL(o).hostname:null}catch{t=null}window.history.length>1&&t===a?window.history.back():window.location.href="/"})}document.addEventListener("DOMContentLoaded",function(){g(),h(),v(),p(),y("#dates-start-end-group","#Estimated-Start-Date")});})();
